rm(list=ls())
library(ISLR)
library(glmnet)
library(pls)
data("College")
summary(College)
cor(College[,-1])
set.seed(630829)
index<-sample(nrow(College),size=627,replace = F)
l1<-lm(Apps~.,data=College[index,])
pred1<-predict(l1,newdata=College[-index,])
mean((pred1-College$Apps[-index])^2)
plot(predict(l1)~College$Apps[index])
plot(pred1~College$Apps[-index])
#which(pred1==max(pred1))
my.x<-model.matrix(Apps~.,data=College[index,])
tst.x<-model.matrix(Apps~.,data=College[-index,])
rm1<-cv.glmnet(x=my.x,y=College$Apps[index],alpha=0,lambda=seq(0.05,500,length.out=1000))
plot(rm1)
rm1$lambda.min
pred2<-predict(rm1,newx=tst.x,s=rm1$lambda.min)
mean((pred2-College$Apps[-index])^2)
ls1<-cv.glmnet(x=my.x,y=College$Apps[index],alpha=1,lambda=seq(0.05,500,length.out=1000))
plot(ls1)
ls1$lambda.min
pred3<-predict(ls1,newx=tst.x,s=ls1$lambda.min)
mean((pred3-College$Apps[-index])^2)
coef(ls1,lambda=ls1$lambda.min)
pc1<-pcr(Apps~.,data=College[index,],ncomp=6,validation="CV")
summary(pc1)
pred4<-predict(pc1,newdata = College[-index,],ncomp = 5)
mean((pred4-College$Apps[-index])^2)
##### Kenneth's Preference ######
l2<-lm(log(Apps)~scale(Top10perc)+scale(Top25perc)+scale(F.Undergrad)+scale(Outstate)
       +scale(Room.Board)+scale(Personal)+scale(PhD)+scale(S.F.Ratio)+
         scale(Expend)+scale(Grad.Rate)+Private,data=College[index,])
summary(l2)
pred2.1<-predict(l2,newdata=College[-index,])
plot(pred2.1~log(College$Apps[-index]))
mean((pred2.1-log(College$Apps[-index]))^2)
x.2<-model.matrix(log(Apps)~scale(Top10perc)+scale(Top25perc)+scale(F.Undergrad)+scale(Outstate)
                  +scale(Room.Board)+scale(Personal)+scale(PhD)+scale(S.F.Ratio)+
                    scale(Expend)+scale(Grad.Rate)+Private,data=College[index,])
x.3<-model.matrix(log(Apps)~scale(Top10perc)+scale(Top25perc)+scale(F.Undergrad)+scale(Outstate)
                  +scale(Room.Board)+scale(Personal)+scale(PhD)+scale(S.F.Ratio)+
                    scale(Expend)+scale(Grad.Rate)+Private,data=College[-index,])
ls2<-cv.glmnet(x=x.2,y=log(College$Apps[index]),intercep=FALSE,alpha=1,lambda=seq(0.05,50,length.out=200))
plot(ls2)
pred2.2<-predict(ls2,newx=x.3,s=ls2$lambda.min)
mean((pred2.2-log(College$Apps[-index]))^2)
coef(ls2,lambda=ls2$lambda.min)
